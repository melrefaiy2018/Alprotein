Metadata-Version: 2.4
Name: Alprotein
Version: 0.2.0
Summary: A fast and modern package for calculating optical spectra of proteins from PDB files
Author-email: Mohamed Elrefaiy <melrefaiy@example.edu>, Bailey Raber <braber@example.edu>, Doran Raccah <draccah@example.edu>
License-Expression: MIT
Project-URL: Homepage, https://github.com/melrefaiy2018/Alprotein-Alpha
Project-URL: Documentation, https://github.com/melrefaiy2018/Alprotein-Alpha
Project-URL: Bug Tracker, https://github.com/melrefaiy2018/Alprotein-Alpha/issues
Classifier: Development Status :: 3 - Alpha
Classifier: Intended Audience :: Science/Research
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.8
Classifier: Programming Language :: Python :: 3.9
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Topic :: Scientific/Engineering :: Bio-Informatics
Classifier: Topic :: Scientific/Engineering :: Chemistry
Classifier: Topic :: Scientific/Engineering :: Physics
Requires-Python: >=3.8
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: numpy>=1.18.0
Requires-Dist: scipy>=1.6.0
Requires-Dist: matplotlib>=3.2.0
Requires-Dist: pandas>=1.2.0
Requires-Dist: biopython>=1.78
Requires-Dist: numba>=0.50.0
Requires-Dist: tqdm>=4.50.0
Requires-Dist: h5py>=2.10.0
Requires-Dist: seaborn>=0.13.0
Provides-Extra: api
Requires-Dist: flask>=2.0.0; extra == "api"
Requires-Dist: flask-cors>=3.0.0; extra == "api"
Provides-Extra: dev
Requires-Dist: pytest>=6.2.0; extra == "dev"
Requires-Dist: pytest-cov>=2.12.0; extra == "dev"
Requires-Dist: black>=21.6b0; extra == "dev"
Requires-Dist: isort>=5.9.0; extra == "dev"
Requires-Dist: flake8>=3.9.0; extra == "dev"
Requires-Dist: mypy>=0.910; extra == "dev"
Requires-Dist: sphinx>=4.0.0; extra == "dev"
Requires-Dist: pydocstyle>=6.3.0; extra == "dev"
Provides-Extra: viz
Requires-Dist: plotly>=5.0.0; extra == "viz"
Dynamic: license-file

<div align="center">
  <img src="docs/assets/logo.png" alt="Alprotein Logo" width="600"/>
</div>


# Alprotein: Interactive GUI and scripting toolkit for excitonic Hamiltonians and optical spectra

**Alprotein makes complex excitonic calculations accessible through an intuitive graphical interface**, while providing the full power of a Python API for advanced users and automation.

Unlike traditional command-line only tools, Alprotein features a **modern GUI workbench** that guides you through the entire workflowâ€”from loading PDB structures to visualizing optical spectraâ€”without writing a single line of code. For researchers who need automation or custom workflows, the same functionality is available through a clean Python API.

<div align="center">
  <img src="docs/assets/alprotein_gif.gif" alt="Alprotein GUI Demo" width="800"/>
  <p><i>Interactive GUI for calculating excitonic properties and optical spectra</i></p>
</div>

## Why Alprotein?

### ðŸ–¥ï¸ **GUI-First Design**
- **Point-and-click workflow** - No programming required for standard calculations
- **Interactive visualization** - Real-time 3D structure viewing and spectra plotting
- **Guided parameter selection** - Built-in tooltips and validation
- **Live feedback** - Watch calculations progress with detailed status updates
- **Export-ready results** - One-click saving of Hamiltonians, spectra, and visualizations

### ðŸ **Powerful Scripting When You Need It**
- Full Python API for automation and batch processing
- Integrate into existing computational pipelines
- Custom workflows and analysis scripts
- Reproducible, version-controlled calculations

### ðŸ”¬ **Complete Workflow**
- Load protein structures from PDB files
- Identify and configure pigments (Chlorophyll A, B, Bacteriochlorophyll, etc.)
- Compute site energies using CDC method
- Calculate pigment-pigment couplings (TrEsp or dipole approximation)
- Build and diagonalize excitonic Hamiltonians
- Generate absorption and fluorescence spectra with vibronic coupling
- Define and analyze excitonic domains

## What Makes Alprotein Different?

Most computational tools for excitonic calculations require extensive programming knowledge and command-line expertise. **Alprotein breaks down this barrier** with a graphical interface that makes sophisticated quantum mechanical calculations accessible to all researchersâ€”from experimental biophysicists to computational experts.

**The GUI is not an afterthought**â€”it's a core feature designed from the ground up to handle the full complexity of excitonic calculations while remaining intuitive and user-friendly.

At the same time, power users get a clean, well-documented Python API for automation, batch processing, and integration into existing pipelines. You're not limited to one approachâ€”use what fits your workflow.

## Installation

### From source

```bash
git clone https://github.com/melrefaiy2018/Alprotein.git
cd Alprotein
conda create -n alprotein python=3.11
conda activate alprotein
pip install -e .
```

### Launch the GUI

After installation, start the interactive workbench:

```bash
python tools/launch_workbench.py 
```

That's it! The GUI will open and guide you through the entire workflow.

### Requirements

- Python 3.8 or newer
- NumPy, SciPy, pandas
- BioPython
- matplotlib
- PyQt5 or PySide6 (for GUI)

## Getting Started

### Using the GUI (Recommended for Most Users)

Launch the interactive workbench:

```bash
python -m Alprotein.workbench
# Or if you have the tools directory:
# python tools/launch_workbench.py
```

The GUI provides a step-by-step workflow:

1. **Load Structure** - Browse and load your PDB file
2. **Configure Pigments** - Select pigment types and parameters from dropdown menus
3. **Compute Properties** - Click to calculate site energies and couplings
4. **Build Hamiltonian** - Set dielectric constants and construct the excitonic Hamiltonian
5. **Calculate Spectra** - Configure temperature, disorder, and generate absorption/fluorescence spectra
6. **Visualize & Export** - Interactive plots and one-click export of all results

**No coding required** - the GUI handles all the complexity while giving you full control over parameters.

---

### Using the Python API (For Advanced Users & Automation)

For scripting, batch processing, or integration into computational pipelines, here's a complete programmatic workflow:

```python
import numpy as np
import matplotlib.pyplot as plt
from Alprotein import (
    ProteinStructure,
    PigmentSystem,
    ChlorophyllA,
    HamiltonianCalculator,
    SpectraCalculator
)

# ============================================================================
# STEP 1: Load Protein Structure
# ============================================================================
print("[1] Loading protein structure...")
protein = ProteinStructure.from_file("structure.pdb", name="MyComplex")
print(f"    âœ“ Loaded structure with {len(protein.atoms)} atoms")

# ============================================================================
# STEP 2: Build Pigment System
# ============================================================================
print("\n[2] Building pigment system...")
pigment_system = PigmentSystem(protein)

# Add chlorophyll A pigments from the structure
pigment_system.add_pigments_by_residue(
    resname="CLA",              # Residue name in PDB file
    pigment_class=ChlorophyllA, # Pigment type class
    tresp_dict_name="CLA_IPPC", # Transition charge parameter set
    cdc_dict_name="CLA",        # CDC parameter set
)

print(f"    âœ“ Identified {len(pigment_system.pigments)} pigments")

# Compute site energies using CDC method
site_energies = pigment_system.compute_site_energies()
print(f"    âœ“ Computed site energies (mean: {np.mean(site_energies):.1f} cmâ»Â¹)")

# Compute pigment-pigment couplings using TrEsp method
couplings = pigment_system.compute_couplings(method="TrEsp")
print(f"    âœ“ Computed couplings (max: {np.max(np.abs(couplings)):.1f} cmâ»Â¹)")

# ============================================================================
# STEP 3: Construct Hamiltonian
# ============================================================================
print("\n[3] Constructing Hamiltonian...")

hamiltonian_calculator = HamiltonianCalculator(
    pigment_system,
    dielectric_cdc=2.0,      # Dielectric constant for CDC calculation
    dielectric_tresp=1.0,    # Dielectric constant for TrEsp coupling
    f_val=0.72,              # Oscillator strength
    E_0a=14900.0,            # Reference energy for Qy transition (cmâ»Â¹)
    E_0b=15674.0             # Reference energy for Qx transition (cmâ»Â¹)
)

# Build the Hamiltonian matrix
hamiltonian_df = hamiltonian_calculator.construct_hamiltonian(
    params={'coupling_calc': 'tresp'}  # Use TrEsp for couplings
)
hamiltonian = hamiltonian_df.values
print(f"    âœ“ Hamiltonian constructed ({hamiltonian.shape[0]}Ã—{hamiltonian.shape[1]})")

# ============================================================================
# STEP 4: Define Excitonic Domains
# ============================================================================
print("\n[4] Defining excitonic domains...")

domain_cutoff = 20.0  # Coupling threshold in cmâ»Â¹
domains_dict = hamiltonian_calculator.build_domains(
    cutoff=domain_cutoff,
    hamiltonian=hamiltonian_df,
)
print(f"    âœ“ Found {len(domains_dict)} domains")

# ============================================================================
# STEP 5: Calculate Optical Spectra
# ============================================================================
print("\n[5] Calculating optical spectra...")

# Set calculation parameters
temperature = 300.0       # Temperature in Kelvin
disorder_fwhm = 130.0     # Inhomogeneous broadening FWHM (cmâ»Â¹)
n_ensemble = 300          # Number of disorder realizations
dt = 0.1                  # Time step in femtoseconds
t_max = 2000.0            # Maximum time in femtoseconds

print(f"    Parameters:")
print(f"      - Temperature: {temperature} K")
print(f"      - Disorder FWHM: {disorder_fwhm} cmâ»Â¹")
print(f"      - Ensemble size: {n_ensemble}")
print(f"      - Time range: 0-{t_max} fs (step: {dt} fs)")

# Initialize spectra calculator
spectra_calc = SpectraCalculator(
    temperature=temperature,
    disorder_sigma=disorder_fwhm,  # Converted to sigma internally
    n_ensemble=n_ensemble,
    dt=dt,
    t_max=t_max
)
print(f"    âœ“ SpectraCalculator initialized")
print(f"      - Reorganization energy: {spectra_calc.reorganization_energy:.1f} cmâ»Â¹")

# Calculate absorption and fluorescence spectra
wavelengths_abs, absorption, wavelengths_fl, fluorescence = spectra_calc.calculate_spectrum(
    hamiltonian=hamiltonian,
    domains=domains_dict,
    pigment_system=pigment_system,
    include_vibronic=True,  # Include 0-1 vibronic transitions
    use_ensemble=True       # Use ensemble averaging
)
print(f"    âœ“ Spectra calculated")

# ============================================================================
# STEP 6: Analyze and Visualize Results
# ============================================================================
print("\n[6] Analyzing results...")

# Find absorption peak
mask_abs = (wavelengths_abs >= 600) & (wavelengths_abs <= 720)
if np.any(mask_abs):
    peak_idx_abs = np.argmax(absorption[mask_abs])
    peak_wl_abs = wavelengths_abs[mask_abs][peak_idx_abs]
else:
    peak_idx_abs = np.argmax(absorption)
    peak_wl_abs = wavelengths_abs[peak_idx_abs]

# Find fluorescence peak
mask_fl = (wavelengths_fl >= 600) & (wavelengths_fl <= 720)
if np.any(mask_fl):
    peak_idx_fl = np.argmax(fluorescence[mask_fl])
    peak_wl_fl = wavelengths_fl[mask_fl][peak_idx_fl]
else:
    peak_idx_fl = np.argmax(fluorescence)
    peak_wl_fl = wavelengths_fl[peak_idx_fl]

print(f"    âœ“ Absorption peak: {peak_wl_abs:.1f} nm")
print(f"    âœ“ Fluorescence peak: {peak_wl_fl:.1f} nm")
print(f"    âœ“ Stokes shift: {peak_wl_fl - peak_wl_abs:.1f} nm")

# Plot spectra
fig, ax = plt.subplots(figsize=(10, 6))
ax.plot(wavelengths_abs, absorption, label='Absorption', linewidth=2)
ax.plot(wavelengths_fl, fluorescence, label='Fluorescence', linewidth=2)
ax.axvline(peak_wl_abs, color='C0', linestyle='--', alpha=0.5)
ax.axvline(peak_wl_fl, color='C1', linestyle='--', alpha=0.5)
ax.set_xlabel('Wavelength (nm)', fontsize=12)
ax.set_ylabel('Intensity (arb. units)', fontsize=12)
ax.set_title('Optical Spectra', fontsize=14, fontweight='bold')
ax.legend(fontsize=11)
ax.grid(alpha=0.3)
plt.tight_layout()
plt.savefig('spectra.png', dpi=300)
print(f"\n    âœ“ Spectra saved to 'spectra.png'")

print("\nâœ… Calculation complete!")
```

### Quick Python Example

For a minimal scripting example (when you need automation):

```python
from Alprotein import ProteinStructure, PigmentSystem, ChlorophyllA

# Load structure and build pigment system
protein = ProteinStructure.from_file("structure.pdb", name="MyComplex")
pigment_system = PigmentSystem(protein)
pigment_system.add_pigments_by_residue(
    resname="CLA",
    pigment_class=ChlorophyllA,
    tresp_dict_name="CLA_IPPC",
    cdc_dict_name="CLA"
)

# Compute energies and couplings
site_energies = pigment_system.compute_site_energies()
couplings = pigment_system.compute_couplings(method="TrEsp")

print(f"Found {len(pigment_system.pigments)} pigments")
print(f"Mean site energy: {site_energies.mean():.1f} cmâ»Â¹")
```

**ðŸ’¡ Tip:** The same workflow is available in the GUI with point-and-click simplicityâ€”no need to remember function names or parameter details!

## GUI vs Scripting: Choose Your Workflow

| Feature | GUI Workbench | Python API |
|---------|---------------|------------|
| **Learning Curve** | Immediate - visual interface | Requires Python knowledge |
| **Best For** | Exploratory research, single calculations | Automation, batch jobs, pipelines |
| **Parameter Selection** | Dropdowns with validation | Manual specification |
| **Visualization** | Built-in interactive plots | Custom matplotlib code |
| **Result Export** | One-click save | Manual file I/O |
| **Reproducibility** | Session save/load | Script version control |
| **Customization** | Guided options | Full programmatic control |

**Use both!** Start with the GUI to explore and understand your system, then use the Python API when you need to automate or customize.

## Project Structure

- `Alprotein/core/` - Core system objects (structure and pigment handling)
- `Alprotein/calculators/` - Site energy, coupling, and Hamiltonian calculators
- `Alprotein/gui/` - Interactive GUI workbench components
- `Alprotein/data/` - Parameter sets for supported pigment types
- `examples/` - Runnable scripting examples and workflows
- `tools/` - Utility scripts including GUI launcher


## License

MIT License.

## Citation

If you use Alprotein in published work, please cite:

```bibtex
@software{Alprotein,
  title={Alprotein: Interactive GUI and scripting toolkit for excitonic Hamiltonians and optical spectra of molecular aggregates},
  author={Mohamed Elrefaiy and Bailey Raber and Doran Raccah},
  year={2025},
  version={0.2.0},
  url={https://github.com/melrefaiy2018/Alprotein},
  note={Features interactive GUI workbench for accessible excitonic calculations}
}
```

## Contributing

We welcome contributions! Please read our [CONTRIBUTING.md](CONTRIBUTING.md) for details on our code of conduct, and the process for submitting pull requests.

## Contact

For any questions or support, please reach out to [melrefaiy@utexas.edu].
